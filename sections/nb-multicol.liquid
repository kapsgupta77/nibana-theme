{% liquid
  assign cols = section.settings.columns | default: 3
%}
<section id="nb-multicol-{{ section.id }}" class="nb-multicol">
  {% if section.settings.overline != blank or section.settings.heading != blank or section.settings.subheading != blank %}
    <div class="nb-multicol__header">
      {% if section.settings.overline != blank %}<p class="nb-overline">{{ section.settings.overline }}</p>{% endif %}
      {% if section.settings.heading != blank %}<h2 class="nb-title">{{ section.settings.heading }}</h2>{% endif %}
      {% if section.settings.subheading != blank %}<p class="nb-sub">{{ section.settings.subheading }}</p>{% endif %}
    </div>
  {% endif %}

  <ul class="nb-grid" style="--cols: {{ cols }};">
    {% for block in section.blocks %}
      <li class="nb-card" {{ block.shopify_attributes }}>
        {% if block.settings.icon != blank %}
          <img class="nb-card__icon" src="{{ block.settings.icon | image_url: width: 120 }}" alt="{{ block.settings.heading | escape }}">
        {% endif %}
        {% if block.settings.heading != blank %}<h3 class="nb-card__title">{{ block.settings.heading }}</h3>{% endif %}
        {% if block.settings.text != blank %}<div class="nb-card__text">{{ block.settings.text }}</div>{% endif %}
        {% if block.settings.link_label != blank and block.settings.link_url != blank %}
          <a class="nb-card__link" href="{{ block.settings.link_url }}">{{ block.settings.link_label }}</a>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
</section>

{% style %}
#nb-multicol-{{ section.id }}{
  --nb-bg: {{ section.settings.bg | default: 'transparent' }};
  --nb-radius: 16px;
  --nb-gap: clamp(16px,1.8vw,24px);
  background: var(--nb-bg);
  padding: clamp(24px,3vw,48px) 0;
}
#nb-multicol-{{ section.id }} .nb-multicol__header{
  max-width: 72rem; margin: 0 auto clamp(16px,2vw,24px); padding: 0 16px; text-align: {{ section.settings.align }};
}
#nb-multicol-{{ section.id }} .nb-title{ color: var(--nb-teal, #10636c); font-weight: 800; letter-spacing: -0.015em; margin: 0 0 8px; }
#nb-multicol-{{ section.id }} .nb-sub{ color: var(--nb-ink, #2f3e48); opacity:.9; margin:0; }
#nb-multicol-{{ section.id }} .nb-grid{
  display:grid; gap: var(--nb-gap); max-width: 72rem; margin:0 auto; padding:0 16px;
  grid-template-columns: repeat(var(--cols), minmax(0,1fr));
}
@media (max-width: 989px){ #nb-multicol-{{ section.id }} .nb-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
@media (max-width: 600px){ #nb-multicol-{{ section.id }} .nb-grid{ grid-template-columns: 1fr; } }
#nb-multicol-{{ section.id }} .nb-card{
  list-style:none; background:#fff; border-radius: var(--nb-radius); box-shadow: 0 6px 20px rgba(0,0,0,.06);
  padding: clamp(16px,1.6vw,24px); display:flex; flex-direction:column; gap:10px;
}
#nb-multicol-{{ section.id }} .nb-card__icon{ width:48px; height:auto; border-radius:8px; }
#nb-multicol-{{ section.id }} .nb-card__title{ margin:0; font-weight:700; color: var(--nb-ink,#2f3e48); }
#nb-multicol-{{ section.id }} .nb-card__text{ color: var(--nb-ink,#2f3e48); opacity:.9; }
#nb-multicol-{{ section.id }} .nb-card__link{
  margin-top:auto; align-self:flex-start; background: var(--nb-chocolate, #d16c28); color:#fff; border-radius:999px; padding:10px 18px;
  text-decoration:none; border:2px solid var(--nb-chocolate,#d16c28);
  transition: transform .08s ease, box-shadow .2s ease, background-color .15s ease;
}
#nb-multicol-{{ section.id }} .nb-card__link:hover{ background: var(--nb-choc-600, #b85c21); }
{% endstyle %}

{% schema %}
{
  "name": "Cards: Multi-column",
  "settings": [
    { "type": "text", "id": "overline", "label": "Overline" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "What we’ll cover" },
    { "type": "textarea", "id": "subheading", "label": "Subheading" },
    {
      "type": "select", "id": "align", "label": "Text alignment",
      "options": [ { "value": "left", "label": "Left" }, { "value": "center", "label": "Center" } ],
      "default": "left"
    },
    { "type": "range", "id": "columns", "label": "Columns on desktop", "min": 2, "max": 4, "step": 1, "default": 3 },
    {
      "type": "select", "id": "bg", "label": "Background",
      "options": [
        { "value": "transparent", "label": "Transparent" },
        { "value": "var(--nb-gainsboro, #e3e4dc)", "label": "Gainsboro" },
        { "value": "var(--nb-soft-green, #eaf5f4)", "label": "Soft green" }
      ],
      "default": "transparent"
    }
  ],
  "blocks": [
    {
      "type": "item",
      "name": "Card",
      "settings": [
        { "type": "image_picker", "id": "icon", "label": "Icon (optional)" },
        { "type": "text", "id": "heading", "label": "Title", "default": "Clarity on your goals" },
        { "type": "richtext", "id": "text", "label": "Text", "default": "<p>We’ll map where you are and what ‘aligned success’ looks like.</p>" },
        { "type": "text", "id": "link_label", "label": "Link label" },
        { "type": "url", "id": "link_url", "label": "Link URL" }
      ]
    }
  ],
  "max_blocks": 8,
  "presets": [
    { "name": "Cards: Multi-column", "blocks": [ { "type": "item" }, { "type": "item" }, { "type": "item" } ] }
  ]
}
{% endschema %}