{% comment %}
About — How we work (explainer)
- Reusable, with intro + list of steps (Title | Blurb on each line)
- Optional CTA
- Optional panel background with selectable color
- Color scheme support
{% endcomment %}

<section
  id="nb-about-how-{{ section.id }}"
  class="nb-about-how {{ section.settings.color_scheme }}"
  style="padding-block-start: {{ section.settings.pad_top }}px; padding-block-end: {{ section.settings.pad_bottom }}px;"
>
  <div class="nb-shell">
    <div
      class="nb-how__wrap"
      {% if section.settings.panel_on %}
        style="--nb-panel-bg: {{ section.settings.panel_color | default: '#F3FAF8' }};"
      {% endif %}
    >
      <header class="nb-how__head">
        {% if section.settings.kicker != blank %}
          <p class="nb-kicker">{{ section.settings.kicker }}</p>
        {% endif %}
        <h2 class="nb-h2 nb-how__title">{{ section.settings.heading }}</h2>

        {% if section.settings.intro_rich != blank %}
          <div class="nb-rte nb-how__intro">
            {{ section.settings.intro_rich }}
          </div>
        {% endif %}
      </header>

     {% liquid
  assign steps_raw = section.settings.steps | default: ''
  assign norm = steps_raw | replace: '\r\n', '\n'
  assign norm = norm | replace: '&#13;', ''
  assign norm = norm | replace: '&#10;', '\n'
  assign as_html = norm | newline_to_br
  assign with_delims = as_html | replace: '<br />', '|||'
  assign with_delims = with_delims | replace: '<br/>', '|||'
  assign with_delims = with_delims | replace: '<br>', '|||'
  assign step_lines = with_delims | split: '|||'
%}

      {% if step_lines.size > 0 %}
        <div class="nb-how__grid" data-cols="{{ section.settings.cols }}">
          {% for line in step_lines %}
            {% assign raw = line | strip %}
            {% if raw != '' %}
              {% assign parts = raw | split: '|' %}
              {% assign st_title = parts[0] | strip %}
              {% assign st_body  = parts[1] | default: '' | strip %}
              <div class="nb-how__item">
                <div class="nb-dot"></div>
                <div class="nb-how__content">
                  {% if st_title != '' %}
                    <h3 class="nb-how__st">{{ st_title }}</h3>
                  {% endif %}
                  {% if st_body != '' %}
                    <p class="nb-how__blurb">{{ st_body }}</p>
                  {% endif %}
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}

      {% if section.settings.cta_label != blank and section.settings.cta_link != blank %}
        <div class="nb-how__cta">
          <a class="nb-cta" href="{{ section.settings.cta_link }}">{{ section.settings.cta_label }}</a>
        </div>
      {% endif %}
    </div>
  </div>

  <style>
    .nb-about-how .nb-how__wrap{
      background: {% if section.settings.panel_on %}var(--nb-panel-bg, var(--nb-mist, #F3FAF8)){% else %}transparent{% endif %};
      border-radius: 20px;
      padding: clamp(18px, 2.4vw, 28px);
      box-shadow: {% if section.settings.panel_on %}0 10px 28px rgba(12,138,123,.08), 0 1px 0 rgba(255,255,255,.8) inset{% else %}none{% endif %};
    }
    .nb-about-how .nb-how__head{ margin-bottom: clamp(12px, 1.8vw, 20px); }
    .nb-about-how .nb-how__intro{ margin-top: 10px; }

    .nb-about-how .nb-how__grid{
      display: grid;
      gap: clamp(14px, 2vw, 20px);
      margin-top: clamp(10px, 1.6vw, 16px);
    }
    @media (min-width: 960px){
      .nb-about-how .nb-how__grid[data-cols="2"]{ grid-template-columns: repeat(2, minmax(0,1fr)); }
      .nb-about-how .nb-how__grid[data-cols="3"]{ grid-template-columns: repeat(3, minmax(0,1fr)); }
    }

    .nb-about-how .nb-how__item{
      display:flex; align-items:flex-start;
      gap:12px; border-radius:14px; background:#fff; padding:16px;
      box-shadow: 0 1px 0 rgba(22,34,31,0.04);
    }
    .nb-about-how .nb-dot{
      inline-size:10px; block-size:10px; border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #ffb26f, #d66c2f);
      margin-top:7px; flex: 0 0 auto;
    }
    .nb-about-how .nb-how__st{ margin:0 0 4px; font-size:1.06rem; }
    .nb-about-how .nb-how__blurb{ margin:0; opacity:.9; }

    .nb-about-how .nb-how__cta{
      margin-top: clamp(16px, 2vw, 22px);
    }
  </style>
</section>

{% schema %}
{
  "name": "About—How we work",
  "class": "section-wrapper nb-about-how-wrap",
  "settings": [
    { "type": "text", "id": "kicker", "label": "Kicker", "default": "How we work" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "A practical, embodied approach" },
    { "type": "richtext", "id": "intro_rich", "label": "Intro (optional)", "default": "<p>Everything we do is designed to create durable change — steady nervous system, clearer choices, more aliveness.</p>" },

    { "type": "select", "id": "cols", "label": "Columns (desktop)", "default": "2",
      "options": [
        { "value": "2", "label": "Two" },
        { "value": "3", "label": "Three" }
      ]
    },

    { "type": "textarea", "id": "steps", "label": "Steps (one per line: Title | Blurb)", "default": "Identity reset | See who you are beyond roles and expectations.\nInner skills | Retrain attention, emotion, and energy with embodied practices.\nAligned action | Make clearer choices and move with less friction.\nPlay-based integration | Build a life that feels alive, meaningful, and sustainable." },

    { "type": "text", "id": "cta_label", "label": "CTA label", "default": "Book a 20-min free call" },
    { "type": "text", "id": "cta_link", "label": "CTA link", "default": "/pages/book-a-call" },

    { "type": "checkbox", "id": "panel_on", "label": "Show panel background", "default": true },
    { "type": "color", "id": "panel_color", "label": "Panel background color", "default": "#F3FAF8" },
    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "scheme-1" },

    { "type": "range", "id": "pad_top", "label": "Top padding", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 },
    { "type": "range", "id": "pad_bottom", "label": "Bottom padding", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 }
  ],
  "presets": [
    { "name": "About—How we work" }
  ]
}
{% endschema %}
