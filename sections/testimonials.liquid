{% comment %} testimonials.liquid - Section file {% endcomment %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>
<style>
  /* ===== NIBANA — Testimonials ===== */

  /* Panel: soft tint, rounded, shadow, consistent rhythm */
  .testimonial-section{
    --brand-teal: #0f5b62;
    --tint: #e8f4f2;              /* matches Mission / Contact vibe */
    --panel-radius: 20px;

    position: relative;
    overflow: visible;            /* allow arrows to sit slightly outside */
    margin-block: clamp(28px, 3.2vw, 48px);
    padding: clamp(28px, 3.2vw, 44px) clamp(16px, 3vw, 32px);
    background: var(--tint);
    border-radius: var(--panel-radius);
    box-shadow: 0 10px 28px rgba(0,0,0,.06);
    text-align: center;
  }

  /* Heading */
  .testimonial-section h2{
    color: var(--brand-teal);
    font-weight: 800;
    font-size: clamp(28px, 3.2vw, 44px);
    line-height: 1.15;
    margin: 0 0 22px 0;
  }

 /* Swiper rail — add L/R gutters and keep slides clipped */
.testimonial-swiper{
  overflow: hidden;                                /* keep hidden slides hidden */
  padding: 0 clamp(64px, 7vw, 36px) 24px;          /* <-- gutters + room for dots */
  position: relative;                              /* anchors arrows */
}

/* Arrows sit inside those gutters (not overlapping cards) */
.testimonial-section .swiper-button-prev{ left: clamp(16px, 2vw, 28px); }
.testimonial-section .swiper-button-next{ right: clamp(16px, 2vw, 28px); }

@media (max-width: 1024px){
  .testimonial-section .swiper-button-prev{ left: 12px; }
  .testimonial-section .swiper-button-next{ right: 12px; }
}

  /* Slides and cards */
  .testimonial-card{
    background: #fff;
    border-radius: 14px;
    padding: 22px;
    text-align: left;
    height: 100%;
    display: flex;
    flex-direction: column;
    gap: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,.08);
  }

  .testimonial-name{
    font-weight: 700;
    color: var(--brand-teal);
  }

  .testimonial-location{
    font-size: 14px;
    color: #4a4a4a;
    margin-bottom: 6px;
  }

  .stars{
    color: var(--brand-teal);
    margin-bottom: 6px;
    letter-spacing: 1px;
  }

  /* Keep card heights visually consistent:
     limit body height and allow scroll inside long quotes */
  .testimonial-content{
    font-size: 16px;
    color: #2b2b2b;
    line-height: 1.5;
    max-height: 10.5rem;          /* tune if you want taller cards */
    overflow-y: auto;
  }

  /* Pagination dots */
  .testimonial-section .swiper-pagination{
    position: relative;
    bottom: auto;
    margin-top: 4px;
  }
  .testimonial-section .swiper-pagination-bullet{
    background: rgba(15,91,98,.35);
    opacity: 1;
    width: 8px; height: 8px;
    margin: 0 3px !important;
  }
  .testimonial-section .swiper-pagination-bullet-active{
    background: var(--brand-teal);
  }

  /* “View All” button */
  .testimonial-button{
    margin-top: 10px;             /* keeps the section tight with FAQ */
  }
  .testimonial-button a{
    background: var(--brand-teal);
    color: #fff;
    padding: 12px 28px;
    border-radius: 999px;
    text-decoration: none;
    font-weight: 600;
    display: inline-block;
    box-shadow: 0 6px 20px rgba(0,0,0,.12);
  }
  .testimonial-button a:hover{
    filter: brightness(1.04);
  }
  .testimonial-button a:focus-visible{
    outline: 3px solid #10636c;
    outline-offset: 3px;
  }

  /* Arrows — outside the card rail */
  .testimonial-section .swiper-button-prev,
  .testimonial-section .swiper-button-next{
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 3;
    width: 44px; height: 44px;
    border-radius: 999px;
    display: grid; place-items: center;
    background: #fff;
    color: var(--brand-teal);
    box-shadow: 0 6px 20px rgba(0,0,0,.14);
  }
  .testimonial-section .swiper-button-prev{ left: -28px; }
  .testimonial-section .swiper-button-next{ right: -28px; }

  /* Replace default arrow glyphs with clean chevrons */
  .testimonial-section .swiper-button-prev::after,
  .testimonial-section .swiper-button-next::after{
    content: "";
    display: block;
    width: 10px; height: 10px;
    border-right: 2px solid currentColor;
    border-bottom: 2px solid currentColor;
  }
  .testimonial-section .swiper-button-prev::after{ transform: rotate(135deg); }
  .testimonial-section .swiper-button-next::after{ transform: rotate(-45deg); }

  /* Tuck arrows slightly on tablets/smaller screens */
  @media (max-width: 1024px){
    .testimonial-section .swiper-button-prev{ left: -12px; }
    .testimonial-section .swiper-button-next{ right: -12px; }
  }
  @media (max-width: 680px){
    /* Optional: hide arrows on very small screens if they feel tight */
    .testimonial-section .swiper-button-prev,
    .testimonial-section .swiper-button-next{ display:none; }
  }
</style>



<section class="testimonial-section">
  <h2>{{ section.settings.heading }}</h2>

 <div class="swiper testimonial-swiper">
  <div class="swiper-wrapper">
    {% for block in section.blocks %}
      <div class="swiper-slide">
        <div class="testimonial-card">
          <div>
            <div class="testimonial-name">{{ block.settings.name }}</div>
            <div class="testimonial-location">{{ block.settings.title }}, {{ block.settings.location }}</div>
            <div class="stars">
              {% for i in (1..5) %}<span>★</span>{% endfor %}
            </div>
            <div class="testimonial-content">{{ block.settings.testimonial }}</div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- Dots -->
  <div class="swiper-pagination"></div>
</div>

<!-- Arrows moved OUTSIDE the swiper so they aren’t clipped -->
<div class="swiper-button-prev"></div>
<div class="swiper-button-next"></div>


  {% if section.settings.button_label != blank and section.settings.button_link != blank %}
    <div class="testimonial-button">
      <a href="{{ section.settings.button_link }}">{{ section.settings.button_label }}</a>
    </div>
  {% endif %}
</section>

<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
<script>
  new Swiper(".testimonial-swiper", {
    slidesPerView: 1,
    spaceBetween: 24,
    pagination: {
      el: ".testimonial-swiper .swiper-pagination",
      clickable: true,
    },
    navigation: {
  nextEl: ".testimonial-section .swiper-button-next",
  prevEl: ".testimonial-section .swiper-button-prev",
},
    breakpoints: {
      768:  { slidesPerView: 2 },
      1024: { slidesPerView: 3 }
    }
  });
</script>

{% schema %}
{
  "name": "Testimonials",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Our Testimonial"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label",
      "default": "VIEW ALL"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        { "type": "text",     "id": "name",        "label": "Name",             "default": "John Doe" },
        { "type": "text",     "id": "title",       "label": "Title / Position", "default": "CEO" },
        { "type": "text",     "id": "location",    "label": "Location",         "default": "New York" },
        { "type": "textarea", "id": "testimonial", "label": "Testimonial Text", "default": "This is a sample testimonial content that will scroll if it gets too long." }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    { "name": "Testimonials", "category": "Custom" }
  ]
}
{% endschema %}
