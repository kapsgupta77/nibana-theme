{%- comment -%}
nb-trustbelt-core
Reusable renderer for trustbelt items.

Accepts via render:
- items  : array of strings (already split; can include <br> or <p> tags)
- layout : 'belt' (default) or 'grid'
- speed  : seconds for marquee (default 22)

Usage:
  {% render 'nb-trustbelt-core', items: _items, layout: _layout, speed: _speed %}
{%- endcomment -%}

{%- liquid
  assign _items  = items
  assign _layout = layout | default: 'belt'
  assign _speed  = speed  | default: 22
-%}

{%- capture _chips -%}
  {%- for it in _items -%}
    {%- assign t = it
      | replace: '<p>', ''
      | replace: '</p>', ''
      | strip -%}
    {%- if t != '' -%}
      <span class="nb-trustbelt__chip"><i aria-hidden="true"></i><span>{{ t }}</span></span>
    {%- endif -%}
  {%- endfor -%}
{%- endcapture -%}

{%- if _chips contains 'nb-trustbelt__chip' -%}
  <style>
    .nb-trustbelt{ --nb-marquee-speed: {{ _speed }}s; }
    .nb-trustbelt__viewport{ overflow: hidden; }
    .nb-trustbelt__track{
      display:flex; gap:14px; padding:12px 18px;
      animation: nb-marquee var(--nb-marquee-speed, 22s) linear infinite;
      will-change: transform;
    }
    @keyframes nb-marquee{ from{ transform: translateX(0) } to{ transform: translateX(-50%) } }
    @media (prefers-reduced-motion: reduce){ .nb-trustbelt__track{ animation:none } }

    .nb-trustbelt__chip{
      display:inline-flex; align-items:center; gap:10px;
      background:#fff; border:1px solid #e8ecef; border-radius:999px;
      padding:10px 14px; white-space:nowrap;
      box-shadow:0 2px 10px rgba(0,0,0,.04);
    }
    .nb-trustbelt__chip > i{
      width:8px; height:8px; border-radius:999px;
      background:#0C8A7B; box-shadow:0 0 0 3px rgba(12,138,123,.12) inset;
      display:inline-block;
    }

    .nb-trustbelt__grid{
      display:grid; gap:12px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }
    .nb-trustbelt__grid .nb-trustbelt__chip{ width:100%; justify-content:flex-start; }
  </style>

  <div class="nb-trustbelt" data-layout="{{ _layout | escape }}">
    <div class="nb-shell">
      {%- if _layout == 'grid' -%}
        <div class="nb-trustbelt__grid">
          {{ _chips }}
        </div>
      {%- else -%}
        <div class="nb-trustbelt__viewport">
          <div class="nb-trustbelt__track">
            {{ _chips }}
            {{ _chips }} {# duplicate for seamless loop #}
          </div>
        </div>
      {%- endif -%}
    </div>
  </div>
{%- endif -%}
